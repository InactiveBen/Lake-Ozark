---
import LiveLayout from '../layouts/LiveLayout.astro';
---

<LiveLayout title="Watch Live">
<div class="fixed inset-0 bg-black flex flex-col">
  <!-- Simple Top Bar -->
  <div class="flex items-center justify-between p-4 bg-black/90 z-50">
    <a href="/" class="flex items-center gap-2 text-white hover:text-gray-300 transition-colors text-lg">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
      </svg>
      <span class="font-medium">Back</span>
    </a>
    
    <div class="flex items-center gap-4">
      <div id="live-badge" class="hidden">
        <span class="inline-flex items-center gap-2 px-4 py-2 bg-red-600 text-white text-base font-semibold rounded-full animate-pulse">
          <span class="w-2 h-2 bg-white rounded-full animate-pulse"></span>
          LIVE NOW
        </span>
      </div>
      <p id="status-text" class="text-base text-gray-300 font-light">
        Sundays at 10:30 AM CT
      </p>
    </div>
  </div>

  <!-- Full Screen Video -->
  <div class="flex-1 relative" style="height: calc(100vh - 80px);">
    <iframe
      id="live-player"
      src="https://customer-w9xtramr9fjat2m3.cloudflarestream.com/b49456d6a25da93af131a919453dc5ad/iframe"
      class="absolute inset-0 w-full h-full border-none"
      allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;"
      allowfullscreen="true"
    ></iframe>
  </div>
</div>

<script>
  // Simple live status check
  function checkIfLive() {
    try {
      const now = new Date();
      const formatter = new Intl.DateTimeFormat('en-US', {
        timeZone: 'America/Chicago',
        hour: '2-digit',
        minute: '2-digit',
        weekday: 'long',
        hour12: false
      });
      
      const parts = formatter.formatToParts(now);
      const day = parts.find(p => p.type === 'weekday')?.value || '';
      const hour = parseInt(parts.find(p => p.type === 'hour')?.value || '0');
      const minute = parseInt(parts.find(p => p.type === 'minute')?.value || '0');
      const currentTime = hour * 60 + minute;
      
      const liveStart = 10 * 60 + 15; // 10:15 AM
      const liveEnd = 12 * 60; // 12:00 PM
      
      const isLive = day === 'Sunday' && currentTime >= liveStart && currentTime <= liveEnd;
      
      const badge = document.getElementById('live-badge');
      const statusText = document.getElementById('status-text');
      
      if (badge && statusText) {
        if (isLive) {
          badge.classList.remove('hidden');
          statusText.textContent = "We're live right now!";
          statusText.classList.remove('text-gray-300');
          statusText.classList.add('text-red-400', 'font-medium');
        } else {
          badge.classList.add('hidden');
          statusText.textContent = "Sundays at 10:30 AM CT";
          statusText.classList.remove('text-red-400', 'font-medium');
          statusText.classList.add('text-gray-300');
        }
      }
    } catch (e) {
      console.error('Live check error:', e);
    }
  }
  
  // Check on load and every minute
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', checkIfLive);
  } else {
    checkIfLive();
  }
  setInterval(checkIfLive, 60000);
</script>

<style>
  * {
    font-family: 'Albert Sans', system-ui, sans-serif;
  }
  
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
  }

  /* Hide scrollbar */
  ::-webkit-scrollbar {
    display: none;
  }

  body {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>
