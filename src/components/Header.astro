---
import { fade } from 'astro:transitions';
import AlertBanner from '../components/AlertBanner.astro';
import EventPromotion from '../components/EventPromotion.astro';
import AlertSmall from '../components/AlertSmall.astro';
import CookieBanner from '../components/CookieBanner.astro';
import SelfXSS from '../components/SelfXSS.astro';
import AccessibilityMenu from '../components/AccessibilityMenu.astro';


---
<SelfXSS />
<AccessibilityMenu />
<CookieBanner />

<EventPromotion
  title="Crucifixion Sculpture Viewing"
  subtitle="Crucifixion Sculpture by Michael Mistler"
  date="Sunday, March 9, 2025"
  time="2:00 PM"
  image="https://cdn.lakeozarkdisciples.org/images/press_cross_release.jpeg"
  persistent={true}
  location="Lake Ozark Christian Church"
  description="Join us to view **The Crucifixion**, a stunning **11.5-foot steel and aluminum sculpture** by Michael Mistler depicting Christ's sacrifice. Public viewing on **Sunday, March 9 at 2:00 PM**, and **Monday-Saturday, March 11-16, from 10:00 AM to 2:00 PM**.\n\nClick below for full details."
  buttonText="Learn More"
  buttonLink="/blog/3"
  messageId="dfhbdf235a"
  expiresAt="2025-03-16T14:30:00-05:00"
/>


<header class="sticky top-0 w-full z-50 bg-white/95 backdrop-blur-sm shadow-sm">
  <nav class="container mx-auto px-4" aria-label="Main navigation">
    <div class="flex justify-between items-center h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center gap-4" aria-label="Lake Ozark Christian Church - Home">
        <img src="https://cdn-locc-org.vercel.app/media/LOCC-header.png" alt="Lake Ozark Christian Church Logo" class="h-12" width="auto" height="48" />
      </a>
      
      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        <!-- Worship Dropdown -->
        <div class="relative group">
          <button 
            class="text-gray-800 hover:text-brand focus:text-brand focus:outline-none font-medium flex items-center gap-1"
            aria-expanded="false"
            aria-haspopup="true"
            aria-controls="worship-menu"
            onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.setAttribute('aria-expanded', this.getAttribute('aria-expanded')==='true'?'false':'true');document.getElementById('worship-menu').classList.toggle('hidden')}"
            onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded')==='true'?'false':'true');document.getElementById('worship-menu').classList.toggle('hidden')"
          >
            Worship
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="worship-menu" class="absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg py-2 hidden" role="menu">
            <a href="/worship" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Service Times</a>
            <a href="/children-youth" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Children & Youth</a>
          </div>
        </div>
        
        <!-- About Dropdown -->
        <div class="relative group">
          <button 
            class="text-gray-800 hover:text-brand focus:text-brand focus:outline-none font-medium flex items-center gap-1"
            aria-expanded="false"
            aria-haspopup="true"
            aria-controls="about-menu"
            onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.setAttribute('aria-expanded', this.getAttribute('aria-expanded')==='true'?'false':'true');document.getElementById('about-menu').classList.toggle('hidden')}"
            onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded')==='true'?'false':'true');document.getElementById('about-menu').classList.toggle('hidden')"
          >
            About
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="about-menu" class="absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg py-2 hidden" role="menu">
            <a href="/about" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Who We Are</a>
            <a href="/chimes" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Newsletter</a>
            <a href="/staff" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Staff</a>
            <a href="https://shelterinastorm.org/" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Shelter in a Storm</a>
            <a href="" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Bylaws</a>
          </div>
        </div>

        <!-- Events Dropdown -->
        <div class="relative group">
          <button 
            class="text-gray-800 hover:text-brand focus:text-brand focus:outline-none font-medium flex items-center gap-1"
            aria-expanded="false"
            aria-haspopup="true"
            aria-controls="events-menu"
            onkeydown="if(event.key==='Enter'||event.key===' '){event.preventDefault();this.setAttribute('aria-expanded', this.getAttribute('aria-expanded')==='true'?'false':'true');document.getElementById('events-menu').classList.toggle('hidden')}"
            onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded')==='true'?'false':'true');document.getElementById('events-menu').classList.toggle('hidden')"
          >
            Events
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="events-menu" class="absolute left-0 mt-2 w-56 bg-white rounded-lg shadow-lg py-2 hidden" role="menu">
            <a href="/weddings" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Weddings</a>
            <a href="/calendar" class="block px-4 py-3 text-gray-800 hover:bg-gray-50 focus:bg-gray-50 focus:outline-none" role="menuitem" tabindex="0">Calendar</a>
          </div>
        </div>
        
        <!-- Regular Links -->
        <a href="/giving" class="text-gray-800 hover:text-brand focus:text-brand focus:outline-none font-medium">Giving</a>
        
        <!-- Blog Link (Replacing Watch Live) -->
        <a 
          href="/blog"
          class="bg-brand hover:bg-brand-dark focus:bg-brand-dark focus:outline-none text-white px-6 py-2 rounded-full font-semibold transition"
        >
          Church News
        </a>
      </div>
      
      <!-- Mobile Menu Button -->
      <button 
        class="md:hidden p-2 hover:bg-gray-100 focus:bg-gray-100 focus:outline-none rounded-lg" 
        id="mobile-menu-button"
        aria-expanded="false"
        aria-controls="mobile-menu"
        aria-label="Toggle navigation menu"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 20 20" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
    
    <!-- Mobile Menu -->
    <div class="md:hidden hidden" id="mobile-menu" role="navigation" aria-label="Mobile navigation">
      <div class="px-2 pt-2 pb-3 space-y-1">
        <div class="border-b border-gray-100 pb-2 mb-2">
          <h2 class="font-medium px-3 py-2 text-gray-800">Worship</h2>
          <a href="/worship" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Service Times</a>
          <a href="/children-youth" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Children & Youth</a>
        </div>

        <div class="border-b border-gray-100 pb-2 mb-2">
          <h2 class="font-medium px-3 py-2 text-gray-800">About</h2>
          <a href="/about" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Who We Are</a>
          <a href="/chimes" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Newsletter</a>
          <a href="/staff" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Staff</a>
          <a href="https://shelterinastorm.org/" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Shelter in a Storm</a>
          <a href="/bylaws" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Bylaws</a>
        </div>

        <div class="border-b border-gray-100 pb-2 mb-2">
          <h2 class="font-medium px-3 py-2 text-gray-800">Events</h2>
          <a href="/weddings" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Weddings</a>
          <a href="/calendar" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Calendar</a>
        </div>

        <a href="/giving" class="block px-3 py-2 text-gray-800 hover:text-brand focus:text-brand focus:outline-none">Giving</a>
        <a href="/blog" class="block px-3 py-2 text-brand font-semibold hover:text-brand-dark focus:text-brand-dark focus:outline-none">Church News</a>
      </div>
    </div>
  </nav>
</header>


<script>
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuButton?.addEventListener('click', () => {
    const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
    mobileMenuButton.setAttribute('aria-expanded', (!isExpanded).toString());
    mobileMenu?.classList.toggle('hidden');
  });

  // Close dropdown menus when clicking outside
  document.addEventListener('click', (event) => {
    const dropdowns = ['worship-menu', 'about-menu', 'events-menu'];
    dropdowns.forEach(id => {
      const menu = document.getElementById(id);
      const button = menu?.previousElementSibling;
      if (menu && button && !button.contains(event.target as Node)) {
        menu.classList.add('hidden');
        button.setAttribute('aria-expanded', 'false');
      }
    });
  });

  // Handle Escape key to close dropdowns
  document.addEventListener('keydown', (event) => {
    if (event.key === 'Escape') {
      const dropdowns = ['worship-menu', 'about-menu', 'events-menu'];
      dropdowns.forEach(id => {
        const menu = document.getElementById(id);
        const button = menu?.previousElementSibling;
        if (menu && button) {
          menu.classList.add('hidden');
          button.setAttribute('aria-expanded', 'false');
        }
      });
    }
  });
</script>

<AlertSmall
  title="After School Program Canceled" 
  message="The after school program for Monday, February 12th, 2025 has been canceled due to inclement weather."
  type="brand"
  icon="info"
  messageId="weather-cancel-2025-02-12"
  expiresAt="2025-02-13"
  fullMessages={[
    {
      title: "After School Program Cancellation Details",
      message: "Due to forecasted inclement weather conditions, the after school program scheduled for Monday, February 12th, 2025 has been canceled.\n\nParents and guardians should make alternate arrangements for student pickup at regular dismissal time.\n\nWe apologize for any inconvenience this may cause.",
      icon: "info"
    }
  ]}
  readMoreText="View Full Details"
  showMailingList={false}
/>
