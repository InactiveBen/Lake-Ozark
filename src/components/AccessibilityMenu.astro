---
/**
 * Accessibility Menu Component
 * WCAG 2.1 AA Compliant
 * Features: Text sizing, contrast, motion, spacing, focus indicators
 */
---

<!-- Skip to main content link (should be first focusable element) -->
<a 
  href="#main-content" 
  class="skip-link"
  id="skip-to-main"
>
  Skip to main content
</a>

<!-- Accessibility Toggle Button -->
<button
  id="a11y-toggle"
  class="a11y-toggle"
  aria-label="Open accessibility settings"
  aria-expanded="false"
  aria-controls="a11y-panel"
  type="button"
>
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
    <circle cx="12" cy="4" r="1"/>
    <path d="M12 21v-8m0 0l-4-4m4 4l4-4"/>
    <path d="M6 11l-2 2m14-2l2 2"/>
  </svg>
  <span class="sr-only">Accessibility</span>
</button>

<!-- Backdrop -->
<div id="a11y-backdrop" class="a11y-backdrop" aria-hidden="true"></div>

<!-- Accessibility Panel -->
<aside
  id="a11y-panel"
  class="a11y-panel"
  role="dialog"
  aria-labelledby="a11y-title"
  aria-modal="true"
  aria-hidden="true"
  tabindex="-1"
>
  <!-- Header -->
  <header class="a11y-header">
    <h2 id="a11y-title">Accessibility</h2>
    <button
      id="a11y-close"
      class="a11y-close"
      aria-label="Close accessibility settings"
      type="button"
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <path d="M18 6L6 18M6 6l12 12"/>
      </svg>
    </button>
  </header>

  <!-- Content -->
  <div class="a11y-content" role="group" aria-label="Accessibility options">
    
    <!-- Text Size -->
    <fieldset class="a11y-fieldset">
      <legend>Text Size</legend>
      <div class="a11y-size-controls">
        <button
          type="button"
          id="size-decrease" 
          class="a11y-size-btn"
          aria-label="Decrease text size"
        >
          <span aria-hidden="true">A−</span>
        </button>
        <output id="size-output" class="a11y-size-output" aria-live="polite">100%</output>
        <button
          type="button"
          id="size-increase" 
          class="a11y-size-btn"
          aria-label="Increase text size"
        >
          <span aria-hidden="true">A+</span>
        </button>
      </div>
    </fieldset>

    <!-- Toggle Options -->
    <fieldset class="a11y-fieldset">
      <legend>Display</legend>
      
      <div class="a11y-option">
        <label for="toggle-contrast" class="a11y-label">
          <span class="a11y-label-text">High contrast</span>
          <span class="a11y-label-desc">Makes text easier to read by increasing color contrast.</span>
        </label>
        <button
          type="button"
          role="switch"
          id="toggle-contrast"
          class="a11y-switch"
          aria-checked="false"
        >
          <span class="a11y-switch-thumb"></span>
        </button>
      </div>

      <div class="a11y-option">
        <label for="toggle-motion" class="a11y-label">
          <span class="a11y-label-text">Reduce motion</span>
          <span class="a11y-label-desc">Turns off animations and moving elements on the page.</span>
        </label>
        <button
          type="button"
          role="switch"
          id="toggle-motion"
          class="a11y-switch"
          aria-checked="false"
        >
          <span class="a11y-switch-thumb"></span>
        </button>
    </div>

      <div class="a11y-option">
        <label for="toggle-links" class="a11y-label">
          <span class="a11y-label-text">Highlight links</span>
          <span class="a11y-label-desc">Adds a yellow background to all links so they stand out.</span>
        </label>
        <button
          type="button"
          role="switch"
          id="toggle-links"
          class="a11y-switch"
          aria-checked="false"
        >
          <span class="a11y-switch-thumb"></span>
        </button>
      </div>

      <div class="a11y-option">
        <label for="toggle-focus" class="a11y-label">
          <span class="a11y-label-text">Enhanced focus</span>
          <span class="a11y-label-desc">Shows a larger outline around items when you navigate with a keyboard.</span>
        </label>
        <button
          type="button"
          role="switch"
          id="toggle-focus"
          class="a11y-switch"
          aria-checked="false"
        >
          <span class="a11y-switch-thumb"></span>
        </button>
      </div>
    </fieldset>

    <!-- Reading -->
    <fieldset class="a11y-fieldset">
      <legend>Reading</legend>

      <div class="a11y-select-group">
        <label for="select-font" class="a11y-select-label">Font style</label>
        <select id="select-font" class="a11y-select">
        <option value="default">Default</option>
          <option value="readable">System readable</option>
          <option value="dyslexic">Dyslexia friendly</option>
      </select>
    </div>

      <div class="a11y-select-group">
        <label for="select-spacing" class="a11y-select-label">Line spacing</label>
        <select id="select-spacing" class="a11y-select">
        <option value="normal">Normal</option>
        <option value="relaxed">Relaxed</option>
        <option value="loose">Loose</option>
      </select>
    </div>
    </fieldset>

    <!-- Keyboard shortcuts -->
    <details class="a11y-shortcuts">
      <summary>Keyboard shortcuts</summary>
      <dl class="a11y-shortcuts-list">
        <div>
          <dt><kbd>Alt</kbd> + <kbd>A</kbd></dt>
          <dd>Opens or closes this menu.</dd>
  </div>
        <div>
          <dt><kbd>Tab</kbd></dt>
          <dd>Moves to the next item.</dd>
      </div>
        <div>
          <dt><kbd>Shift</kbd> + <kbd>Tab</kbd></dt>
          <dd>Moves to the previous item.</dd>
    </div>
        <div>
          <dt><kbd>Enter</kbd> or <kbd>Space</kbd></dt>
          <dd>Activates buttons and links.</dd>
  </div>
        <div>
          <dt><kbd>Escape</kbd></dt>
          <dd>Closes dialogs and menus.</dd>
</div>
      </dl>
    </details>

  </div>

  <!-- Footer -->
  <footer class="a11y-footer">
    <button type="button" id="a11y-reset" class="a11y-reset-btn">
      Reset to Defaults
    </button>
  </footer>
</aside>

<!-- Live Region for Announcements -->
<div id="a11y-announcer" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

<script>
  // Default settings
  const defaults = {
    fontSize: 100,
    contrast: false,
    reduceMotion: false,
    highlightLinks: false,
    enhancedFocus: false,
    font: 'default',
    spacing: 'normal'
  };

  // Current settings
  let settings = { ...defaults };

  // DOM Elements
  const toggle = document.getElementById('a11y-toggle');
  const panel = document.getElementById('a11y-panel');
  const backdrop = document.getElementById('a11y-backdrop');
  const closeBtn = document.getElementById('a11y-close');
  const announcer = document.getElementById('a11y-announcer');
  
  const sizeDecrease = document.getElementById('size-decrease');
  const sizeIncrease = document.getElementById('size-increase');
  const sizeOutput = document.getElementById('size-output');
  
  const toggleContrast = document.getElementById('toggle-contrast');
  const toggleMotion = document.getElementById('toggle-motion');
  const toggleLinks = document.getElementById('toggle-links');
  const toggleFocus = document.getElementById('toggle-focus');
  
  const selectFont = document.getElementById('select-font') as HTMLSelectElement;
  const selectSpacing = document.getElementById('select-spacing') as HTMLSelectElement;
  
  const resetBtn = document.getElementById('a11y-reset');

  // Announce to screen readers
  function announce(message: string) {
    if (announcer) {
      announcer.textContent = message;
      // Clear after announcement
      setTimeout(() => { announcer.textContent = ''; }, 1000);
    }
  }

  // Check if personalization cookies are allowed
  function canSave(): boolean {
    const consent = document.cookie.split('; ').find(row => row.startsWith('cookie-consent='));
    if (!consent) return false;
    const value = decodeURIComponent(consent.split('=')[1]);
    return value === 'all' || value === 'partial';
  }

  // Load settings from cookie
  function loadSettings() {
    if (!canSave()) return;
    
    const saved = document.cookie.split('; ').find(row => row.startsWith('a11y-settings='));
    if (saved) {
      try {
        const parsed = JSON.parse(decodeURIComponent(saved.split('=')[1]));
        settings = { ...defaults, ...parsed };
      } catch (e) {
        console.error('Failed to parse accessibility settings');
      }
    }
  }

  // Save settings to cookie
  function saveSettings() {
    if (!canSave()) return;
    
    const expires = new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toUTCString();
    document.cookie = `a11y-settings=${encodeURIComponent(JSON.stringify(settings))}; expires=${expires}; path=/; SameSite=Lax`;
  }

  // Apply all settings to the page
  function applySettings() {
    const html = document.documentElement;
    const body = document.body;
    
    // Font size
    html.style.fontSize = `${(settings.fontSize / 100) * 16}px`;
    if (sizeOutput) sizeOutput.textContent = `${settings.fontSize}%`;
    
    // High contrast
    body.classList.toggle('a11y-high-contrast', settings.contrast);
    if (toggleContrast) toggleContrast.setAttribute('aria-checked', String(settings.contrast));
    
    // Reduce motion
    body.classList.toggle('a11y-reduce-motion', settings.reduceMotion);
    if (toggleMotion) toggleMotion.setAttribute('aria-checked', String(settings.reduceMotion));
    
    // Highlight links
    body.classList.toggle('a11y-highlight-links', settings.highlightLinks);
    if (toggleLinks) toggleLinks.setAttribute('aria-checked', String(settings.highlightLinks));
    
    // Enhanced focus
    body.classList.toggle('a11y-enhanced-focus', settings.enhancedFocus);
    if (toggleFocus) toggleFocus.setAttribute('aria-checked', String(settings.enhancedFocus));
    
    // Font family
    body.classList.remove('a11y-font-readable', 'a11y-font-dyslexic');
    if (settings.font === 'readable') body.classList.add('a11y-font-readable');
    if (settings.font === 'dyslexic') body.classList.add('a11y-font-dyslexic');
    if (selectFont) selectFont.value = settings.font;
    
    // Line spacing
    body.classList.remove('a11y-spacing-relaxed', 'a11y-spacing-loose');
    if (settings.spacing === 'relaxed') body.classList.add('a11y-spacing-relaxed');
    if (settings.spacing === 'loose') body.classList.add('a11y-spacing-loose');
    if (selectSpacing) selectSpacing.value = settings.spacing;
  }

  // Open panel
  function openPanel() {
    panel?.classList.add('is-open');
    backdrop?.classList.add('is-visible');
    toggle?.setAttribute('aria-expanded', 'true');
    panel?.setAttribute('aria-hidden', 'false');
    panel?.focus();
    document.body.style.overflow = 'hidden';
    announce('Accessibility settings opened');
  }

  // Close panel
  function closePanel() {
    panel?.classList.remove('is-open');
    backdrop?.classList.remove('is-visible');
    toggle?.setAttribute('aria-expanded', 'false');
    panel?.setAttribute('aria-hidden', 'true');
    document.body.style.overflow = '';
    toggle?.focus();
    announce('Accessibility settings closed');
  }

  // Trap focus within panel
  function trapFocus(e: KeyboardEvent) {
    if (!panel?.classList.contains('is-open')) return;
    
    const focusable = panel.querySelectorAll<HTMLElement>(
      'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
    );
    const first = focusable[0];
    const last = focusable[focusable.length - 1];
    
    if (e.key === 'Tab') {
      if (e.shiftKey && document.activeElement === first) {
        e.preventDefault();
        last?.focus();
      } else if (!e.shiftKey && document.activeElement === last) {
        e.preventDefault();
        first?.focus();
      }
    }
    
    if (e.key === 'Escape') {
      closePanel();
    }
  }

  // Initialize
  function init() {
    // Check for system preference for reduced motion
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      settings.reduceMotion = true;
    }
    
    // Check for system preference for high contrast
    if (window.matchMedia('(prefers-contrast: more)').matches) {
      settings.contrast = true;
    }
    
    loadSettings();
    applySettings();
    
    // Toggle button
    toggle?.addEventListener('click', () => {
      if (panel?.classList.contains('is-open')) {
        closePanel();
      } else {
        openPanel();
      }
    });
    
    // Close button
    closeBtn?.addEventListener('click', closePanel);
    
    // Backdrop click
    backdrop?.addEventListener('click', closePanel);
    
    // Keyboard navigation
    document.addEventListener('keydown', trapFocus);
    
    // Global keyboard shortcut (Alt+A)
    document.addEventListener('keydown', (e) => {
      if (e.altKey && e.key.toLowerCase() === 'a') {
        e.preventDefault();
        if (panel?.classList.contains('is-open')) {
          closePanel();
        } else {
          openPanel();
        }
      }
    });
    
    // Font size controls
    sizeDecrease?.addEventListener('click', () => {
      if (settings.fontSize > 75) {
        settings.fontSize -= 25;
        applySettings();
        saveSettings();
        announce(`Text size ${settings.fontSize}%`);
      }
    });
    
    sizeIncrease?.addEventListener('click', () => {
      if (settings.fontSize < 200) {
        settings.fontSize += 25;
        applySettings();
        saveSettings();
        announce(`Text size ${settings.fontSize}%`);
      }
    });
    
    // Toggle switches
    function setupToggle(btn: HTMLElement | null, key: keyof typeof settings, label: string) {
      btn?.addEventListener('click', () => {
        (settings as any)[key] = !(settings as any)[key];
        applySettings();
        saveSettings();
        announce(`${label} ${(settings as any)[key] ? 'enabled' : 'disabled'}`);
      });
    }
    
    setupToggle(toggleContrast, 'contrast', 'High contrast');
    setupToggle(toggleMotion, 'reduceMotion', 'Reduce motion');
    setupToggle(toggleLinks, 'highlightLinks', 'Highlight links');
    setupToggle(toggleFocus, 'enhancedFocus', 'Enhanced focus');
    
    // Select controls
    selectFont?.addEventListener('change', () => {
      settings.font = selectFont.value;
      applySettings();
      saveSettings();
      announce(`Font changed to ${selectFont.options[selectFont.selectedIndex].text}`);
    });
    
    selectSpacing?.addEventListener('change', () => {
      settings.spacing = selectSpacing.value;
      applySettings();
      saveSettings();
      announce(`Line spacing changed to ${selectSpacing.options[selectSpacing.selectedIndex].text}`);
    });
    
    // Reset button
    resetBtn?.addEventListener('click', () => {
      settings = { ...defaults };
      applySettings();
      saveSettings();
      announce('Settings reset to defaults');
    });
  }
  
  // Run on DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
    } else {
    init();
  }
</script>

<style is:global>
  /* ===== Skip Link ===== */
  .skip-link {
    position: fixed;
    top: -100%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    padding: 1rem 2rem;
    background: #1a1a2e;
    color: #fff;
    font-weight: 600;
    text-decoration: none;
    border-radius: 0 0 0.5rem 0.5rem;
    transition: top 0.2s ease;
  }
  
  .skip-link:focus {
    top: 0;
    outline: 3px solid #fbbf24;
    outline-offset: 2px;
  }

  /* ===== Screen Reader Only ===== */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* ===== Toggle Button ===== */
  .a11y-toggle {
    position: fixed;
    bottom: 5rem;
    right: 1.25rem;
    z-index: 120;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 3rem;
    height: 3rem;
    padding: 0;
    background: #1a1a2e;
    color: #fff;
    border: 2px solid transparent;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: transform 0.2s ease, background 0.2s ease;
  }
  
  .a11y-toggle:hover {
    background: #2d2d44;
    transform: scale(1.05);
  }
  
  .a11y-toggle:focus {
    outline: none;
    border-color: #fbbf24;
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.4);
  }

  /* ===== Backdrop ===== */
  .a11y-backdrop {
    position: fixed;
    inset: 0;
    z-index: 130;
    background: rgba(0, 0, 0, 0.5);
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  
  .a11y-backdrop.is-visible {
    opacity: 1;
    visibility: visible;
  }
  
  .a11y-reduce-motion .a11y-backdrop {
    transition: none;
  }

  /* ===== Panel ===== */
  .a11y-panel {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    z-index: 140;
    width: 100%;
    max-width: 380px;
    background: #fff;
    box-shadow: -4px 0 24px rgba(0, 0, 0, 0.15);
    transform: translateX(100%);
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .a11y-panel.is-open {
    transform: translateX(0);
  }
  
  .a11y-reduce-motion .a11y-panel {
    transition: none;
  }

  /* ===== Header ===== */
  .a11y-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1.25rem 1.5rem;
    background: #1a1a2e;
    color: #fff;
  }
  
  .a11y-header h2 {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
  }
  
  .a11y-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    padding: 0;
    background: transparent;
    color: #fff;
    border: 2px solid transparent;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: background 0.15s ease;
  }
  
  .a11y-close:hover {
    background: rgba(255, 255, 255, 0.1);
  }
  
  .a11y-close:focus {
    outline: none;
    border-color: #fbbf24;
  }

  /* ===== Content ===== */
  .a11y-content {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
  }

  /* ===== Fieldset ===== */
  .a11y-fieldset {
    margin: 0 0 1.5rem;
    padding: 0;
    border: none;
  }
  
  .a11y-fieldset legend {
    display: block;
    margin-bottom: 0.75rem;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #6b7280;
  }

  /* ===== Size Controls ===== */
  .a11y-size-controls {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: #f3f4f6;
    border-radius: 0.75rem;
  }
  
  .a11y-size-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 3rem;
    height: 3rem;
    padding: 0;
    background: #fff;
    color: #1a1a2e;
    font-size: 1.125rem;
    font-weight: 700;
    border: 2px solid #e5e7eb;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  
  .a11y-size-btn:hover {
    background: #1a1a2e;
    color: #fff;
    border-color: #1a1a2e;
  }
  
  .a11y-size-btn:focus {
    outline: none;
    border-color: #fbbf24;
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
  }
  
  .a11y-size-output {
    flex: 1;
    text-align: center;
    font-size: 1.25rem;
    font-weight: 700;
    font-variant-numeric: tabular-nums;
    color: #1a1a2e;
  }

  /* ===== Toggle Option ===== */
  .a11y-option {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 1rem;
    padding: 1rem 0;
    border-bottom: 1px solid #e5e7eb;
  }
  
  .a11y-option:last-child {
    border-bottom: none;
  }
  
  .a11y-label {
    flex: 1;
    cursor: pointer;
  }
  
  .a11y-label-text {
    display: block;
    font-size: 0.9375rem;
    font-weight: 600;
    color: #1a1a2e;
  }
  
  .a11y-label-desc {
    display: block;
    margin-top: 0.25rem;
    font-size: 0.8125rem;
    color: #6b7280;
    line-height: 1.4;
  }

  /* ===== Switch ===== */
  .a11y-switch {
    position: relative;
    flex-shrink: 0;
    width: 3rem;
    height: 1.75rem;
    padding: 0;
    background: #d1d5db;
    border: 2px solid transparent;
    border-radius: 999px;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  
  .a11y-switch[aria-checked="true"] {
    background: #10b981;
  }
  
  .a11y-switch:focus {
    outline: none;
    border-color: #fbbf24;
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
  }
  
  .a11y-switch-thumb {
    position: absolute;
    top: 2px;
    left: 2px;
    width: 1.25rem;
    height: 1.25rem;
    background: #fff;
    border-radius: 50%;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease;
  }
  
  .a11y-switch[aria-checked="true"] .a11y-switch-thumb {
    transform: translateX(1.25rem);
  }
  
  .a11y-reduce-motion .a11y-switch,
  .a11y-reduce-motion .a11y-switch-thumb {
    transition: none;
  }

  /* ===== Select ===== */
  .a11y-select-group {
    margin-bottom: 1rem;
  }
  
  .a11y-select-group:last-child {
    margin-bottom: 0;
  }
  
  .a11y-select-label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: #1a1a2e;
  }
  
  .a11y-select {
    width: 100%;
    padding: 0.75rem 1rem;
    font-size: 0.9375rem;
    color: #1a1a2e;
    background: #f9fafb;
    border: 2px solid #e5e7eb;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: border-color 0.15s ease;
  }
  
  .a11y-select:hover {
    border-color: #9ca3af;
  }
  
  .a11y-select:focus {
    outline: none;
    border-color: #fbbf24;
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
  }

  /* ===== Shortcuts ===== */
  .a11y-shortcuts {
    margin-top: 1rem;
    padding: 1rem;
    background: #f9fafb;
    border-radius: 0.75rem;
  }
  
  .a11y-shortcuts summary {
    font-size: 0.875rem;
    font-weight: 600;
    color: #1a1a2e;
    cursor: pointer;
    list-style: none;
  }
  
  .a11y-shortcuts summary::-webkit-details-marker {
    display: none;
  }
  
  .a11y-shortcuts summary::before {
    content: "▸ ";
  }
  
  .a11y-shortcuts[open] summary::before {
    content: "▾ ";
  }
  
  .a11y-shortcuts-list {
    margin: 1rem 0 0;
    padding: 0;
  }
  
  .a11y-shortcuts-list > div {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    font-size: 0.8125rem;
    border-bottom: 1px solid #e5e7eb;
  }
  
  .a11y-shortcuts-list > div:last-child {
    border-bottom: none;
  }
  
  .a11y-shortcuts-list dt {
    font-weight: 400;
  }
  
  .a11y-shortcuts-list dd {
    margin: 0;
    color: #6b7280;
  }
  
  .a11y-shortcuts-list kbd {
    display: inline-block;
    padding: 0.125rem 0.375rem;
    font-family: inherit;
    font-size: 0.75rem;
    background: #fff;
    border: 1px solid #d1d5db;
    border-radius: 0.25rem;
    box-shadow: 0 1px 0 #d1d5db;
  }

  /* ===== Footer ===== */
  .a11y-footer {
    padding: 1rem 1.5rem;
    border-top: 1px solid #e5e7eb;
  }
  
  .a11y-reset-btn {
    width: 100%;
    padding: 0.875rem 1rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: #6b7280;
    background: #f3f4f6;
    border: 2px solid transparent;
    border-radius: 0.5rem;
    cursor: pointer;
    transition: all 0.15s ease;
  }
  
  .a11y-reset-btn:hover {
    background: #e5e7eb;
    color: #1a1a2e;
  }
  
  .a11y-reset-btn:focus {
    outline: none;
    border-color: #fbbf24;
    box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.3);
  }

  /* ===== Accessibility Classes Applied to Body ===== */
  
  /* High Contrast */
  .a11y-high-contrast {
    filter: contrast(1.25);
  }
  
  .a11y-high-contrast img {
    filter: contrast(0.8);
  }

  /* Reduce Motion */
  .a11y-reduce-motion,
  .a11y-reduce-motion * {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
    scroll-behavior: auto !important;
  }

  /* Highlight Links */
  .a11y-highlight-links a:not(.a11y-toggle):not(.a11y-close):not(.skip-link) {
    background: linear-gradient(to bottom, transparent 60%, #fef08a 60%) !important;
    text-decoration: underline !important;
    text-underline-offset: 2px;
  }
  
  .a11y-highlight-links a:not(.a11y-toggle):not(.a11y-close):not(.skip-link):hover {
    background: #fef08a !important;
  }

  /* Enhanced Focus */
  .a11y-enhanced-focus *:focus {
    outline: 3px solid #fbbf24 !important;
    outline-offset: 3px !important;
  }
  
  .a11y-enhanced-focus *:focus:not(:focus-visible) {
    outline: none !important;
  }
  
  .a11y-enhanced-focus *:focus-visible {
    outline: 3px solid #fbbf24 !important;
    outline-offset: 3px !important;
  }

  /* Readable Font */
  .a11y-font-readable,
  .a11y-font-readable * {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif !important;
  }

  /* Dyslexia Friendly Font */
  .a11y-font-dyslexic,
  .a11y-font-dyslexic * {
    font-family: "OpenDyslexic", "Comic Sans MS", sans-serif !important;
    letter-spacing: 0.05em !important;
    word-spacing: 0.1em !important;
  }

  /* Line Spacing */
  .a11y-spacing-relaxed p,
  .a11y-spacing-relaxed li,
  .a11y-spacing-relaxed td,
  .a11y-spacing-relaxed th {
    line-height: 1.75 !important;
  }
  
  .a11y-spacing-loose p,
  .a11y-spacing-loose li,
  .a11y-spacing-loose td,
  .a11y-spacing-loose th {
    line-height: 2 !important;
  }

  /* ===== Media Queries ===== */
  @media (max-width: 480px) {
    .a11y-panel {
      max-width: 100%;
    }
    
    .a11y-toggle {
      bottom: 4rem;
      right: 1rem;
    }
  }
  
  /* Respect user's motion preference */
  @media (prefers-reduced-motion: reduce) {
    .a11y-backdrop,
    .a11y-panel,
    .a11y-switch,
    .a11y-switch-thumb {
      transition: none;
    }
  }
</style>
